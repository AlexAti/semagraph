shadow$provide.module$node_modules$$zxing$library$cjs$core$aztec$encoder$HighLevelEncoder=function(global,require,module,exports){var __values=this&&this.__values||function(o){var s="function"===typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"===typeof o.length)return{next:function(){o&&i>=o.length&&(o=void 0);return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.");};Object.defineProperty(exports,"__esModule",
{value:!0});var Collections_1=require("module$node_modules$$zxing$library$cjs$core$util$Collections"),State_1=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$State"),C=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$EncoderConstants"),CharMap=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$CharMap"),ShiftTable=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$ShiftTable"),StringUtils_1=require("module$node_modules$$zxing$library$cjs$core$common$StringUtils");
global=function(){function HighLevelEncoder(text){this.text=text}HighLevelEncoder.prototype.encode=function(){for(var spaceCharCode=StringUtils_1.default.getCharCode(" "),lineBreakCharCode=StringUtils_1.default.getCharCode("\n"),states=Collections_1.default.singletonList(State_1.default.INITIAL_STATE),index=0;index<this.text.length;index++){var pairCode=void 0;pairCode=index+1<this.text.length?this.text[index+1]:0;switch(this.text[index]){case StringUtils_1.default.getCharCode("\r"):pairCode=pairCode===
lineBreakCharCode?2:0;break;case StringUtils_1.default.getCharCode("."):pairCode=pairCode===spaceCharCode?3:0;break;case StringUtils_1.default.getCharCode(","):pairCode=pairCode===spaceCharCode?4:0;break;case StringUtils_1.default.getCharCode(":"):pairCode=pairCode===spaceCharCode?5:0;break;default:pairCode=0}0<pairCode?(states=HighLevelEncoder.updateStateListForPair(states,index,pairCode),index++):states=this.updateStateListForChar(states,index)}return Collections_1.default.min(states,function(a,
b){return a.getBitCount()-b.getBitCount()}).toBitArray(this.text)};HighLevelEncoder.prototype.updateStateListForChar=function(states,index){var _a,result=[];try{for(var states_1=__values(states),states_1_1=states_1.next();!states_1_1.done;states_1_1=states_1.next())this.updateStateForChar(states_1_1.value,index,result)}catch(e_1_1){var e_1={error:e_1_1}}finally{try{states_1_1&&!states_1_1.done&&(_a=states_1.return)&&_a.call(states_1)}finally{if(e_1)throw e_1.error;}}return HighLevelEncoder.simplifyStates(result)};
HighLevelEncoder.prototype.updateStateForChar=function(state,index,result){for(var ch=this.text[index]&255,charInCurrentTable=0<CharMap.CHAR_MAP[state.getMode()][ch],stateNoBinary=null,mode=0;mode<=C.MODE_PUNCT;mode++){var charInMode=CharMap.CHAR_MAP[mode][ch];if(0<charInMode){null==stateNoBinary&&(stateNoBinary=state.endBinaryShift(index));if(!charInCurrentTable||mode===state.getMode()||mode===C.MODE_DIGIT){var latchState=stateNoBinary.latchAndAppend(mode,charInMode);result.push(latchState)}!charInCurrentTable&&
0<=ShiftTable.SHIFT_TABLE[state.getMode()][mode]&&(charInMode=stateNoBinary.shiftAndAppend(mode,charInMode),result.push(charInMode))}}if(0<state.getBinaryShiftByteCount()||0===CharMap.CHAR_MAP[state.getMode()][ch])state=state.addBinaryShiftChar(index),result.push(state)};HighLevelEncoder.updateStateListForPair=function(states,index,pairCode){var _a,result=[];try{for(var states_2=__values(states),states_2_1=states_2.next();!states_2_1.done;states_2_1=states_2.next())this.updateStateForPair(states_2_1.value,
index,pairCode,result)}catch(e_2_1){var e_2={error:e_2_1}}finally{try{states_2_1&&!states_2_1.done&&(_a=states_2.return)&&_a.call(states_2)}finally{if(e_2)throw e_2.error;}}return this.simplifyStates(result)};HighLevelEncoder.updateStateForPair=function(state,index,pairCode,result){var stateNoBinary=state.endBinaryShift(index);result.push(stateNoBinary.latchAndAppend(C.MODE_PUNCT,pairCode));state.getMode()!==C.MODE_PUNCT&&result.push(stateNoBinary.shiftAndAppend(C.MODE_PUNCT,pairCode));if(3===pairCode||
4===pairCode)pairCode=stateNoBinary.latchAndAppend(C.MODE_DIGIT,16-pairCode).latchAndAppend(C.MODE_DIGIT,1),result.push(pairCode);0<state.getBinaryShiftByteCount()&&(state=state.addBinaryShiftChar(index).addBinaryShiftChar(index+1),result.push(state))};HighLevelEncoder.simplifyStates=function(states){var _a,e_4,_b,result=[];try{for(var states_3=__values(states),states_3_1=states_3.next();!states_3_1.done;states_3_1=states_3.next()){var newState=states_3_1.value,add=!0;states=function(oldState){if(oldState.isBetterThanOrEqualTo(newState))return add=
!1,"break";newState.isBetterThanOrEqualTo(oldState)&&(result=result.filter(function(x){return x!==oldState}))};try{for(var result_1=(e_4=void 0,__values(result)),result_1_1=result_1.next();!result_1_1.done&&"break"!==states(result_1_1.value);result_1_1=result_1.next());}catch(e_4_1){e_4={error:e_4_1}}finally{try{result_1_1&&!result_1_1.done&&(_b=result_1.return)&&_b.call(result_1)}finally{if(e_4)throw e_4.error;}}add&&result.push(newState)}}catch(e_3_1){var e_3={error:e_3_1}}finally{try{states_3_1&&
!states_3_1.done&&(_a=states_3.return)&&_a.call(states_3)}finally{if(e_3)throw e_3.error;}}return result};return HighLevelEncoder}();exports.default=global}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$aztec$encoder$HighLevelEncoder.js.map
