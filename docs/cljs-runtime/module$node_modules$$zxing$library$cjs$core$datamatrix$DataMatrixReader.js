shadow$provide.module$node_modules$$zxing$library$cjs$core$datamatrix$DataMatrixReader=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var BarcodeFormat_1=require("module$node_modules$$zxing$library$cjs$core$BarcodeFormat"),BitMatrix_1=require("module$node_modules$$zxing$library$cjs$core$common$BitMatrix"),DecodeHintType_1=require("module$node_modules$$zxing$library$cjs$core$DecodeHintType"),NotFoundException_1=require("module$node_modules$$zxing$library$cjs$core$NotFoundException"),
Result_1=require("module$node_modules$$zxing$library$cjs$core$Result"),ResultMetadataType_1=require("module$node_modules$$zxing$library$cjs$core$ResultMetadataType"),System_1=require("module$node_modules$$zxing$library$cjs$core$util$System"),Decoder_1=require("module$node_modules$$zxing$library$cjs$core$datamatrix$decoder$Decoder"),Detector_1=require("module$node_modules$$zxing$library$cjs$core$datamatrix$detector$Detector");global=function(){function DataMatrixReader(){this.decoder=new Decoder_1.default}
DataMatrixReader.prototype.decode=function(image,hints){void 0===hints&&(hints=null);null!=hints&&hints.has(DecodeHintType_1.default.PURE_BARCODE)?(image=DataMatrixReader.extractPureBits(image.getBlackMatrix()),image=this.decoder.decode(image),hints=DataMatrixReader.NO_POINTS):(hints=(new Detector_1.default(image.getBlackMatrix())).detect(),image=this.decoder.decode(hints.getBits()),hints=hints.getPoints());var rawBytes=image.getRawBytes();hints=new Result_1.default(image.getText(),rawBytes,8*rawBytes.length,
hints,BarcodeFormat_1.default.DATA_MATRIX,System_1.default.currentTimeMillis());rawBytes=image.getByteSegments();null!=rawBytes&&hints.putMetadata(ResultMetadataType_1.default.BYTE_SEGMENTS,rawBytes);image=image.getECLevel();null!=image&&hints.putMetadata(ResultMetadataType_1.default.ERROR_CORRECTION_LEVEL,image);return hints};DataMatrixReader.prototype.reset=function(){};DataMatrixReader.extractPureBits=function(image){var leftTopBlack=image.getTopLeftOnBit(),rightBottomBlack=image.getBottomRightOnBit();
if(null==leftTopBlack||null==rightBottomBlack)throw new NotFoundException_1.default;var moduleSize=this.moduleSize(leftTopBlack,image),top=leftTopBlack[1];leftTopBlack=leftTopBlack[0];var matrixWidth=(rightBottomBlack[0]-leftTopBlack+1)/moduleSize;rightBottomBlack=(rightBottomBlack[1]-top+1)/moduleSize;if(0>=matrixWidth||0>=rightBottomBlack)throw new NotFoundException_1.default;var nudge=moduleSize/2;top+=nudge;leftTopBlack+=nudge;nudge=new BitMatrix_1.default(matrixWidth,rightBottomBlack);for(var y=
0;y<rightBottomBlack;y++)for(var iOffset=top+y*moduleSize,x=0;x<matrixWidth;x++)image.get(leftTopBlack+x*moduleSize,iOffset)&&nudge.set(x,y);return nudge};DataMatrixReader.moduleSize=function(leftTopBlack,image){for(var width=image.getWidth(),x=leftTopBlack[0],y=leftTopBlack[1];x<width&&image.get(x,y);)x++;if(x===width)throw new NotFoundException_1.default;leftTopBlack=x-leftTopBlack[0];if(0===leftTopBlack)throw new NotFoundException_1.default;return leftTopBlack};DataMatrixReader.NO_POINTS=[];return DataMatrixReader}();
exports.default=global}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$datamatrix$DataMatrixReader.js.map
