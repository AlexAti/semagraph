shadow$provide.module$node_modules$$zxing$library$cjs$core$qrcode$decoder$DecodedBitStreamParser=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var BitSource_1=require("module$node_modules$$zxing$library$cjs$core$common$BitSource"),CharacterSetECI_1=require("module$node_modules$$zxing$library$cjs$core$common$CharacterSetECI"),DecoderResult_1=require("module$node_modules$$zxing$library$cjs$core$common$DecoderResult"),StringUtils_1=require("module$node_modules$$zxing$library$cjs$core$common$StringUtils"),
FormatException_1=require("module$node_modules$$zxing$library$cjs$core$FormatException"),StringBuilder_1=require("module$node_modules$$zxing$library$cjs$core$util$StringBuilder"),StringEncoding_1=require("module$node_modules$$zxing$library$cjs$core$util$StringEncoding"),Mode_1=require("module$node_modules$$zxing$library$cjs$core$qrcode$decoder$Mode");global=function(){function DecodedBitStreamParser(){}DecodedBitStreamParser.decode=function(bytes,version,ecLevel,hints){var bits=new BitSource_1.default(bytes),
result=new StringBuilder_1.default,byteSegments=[],symbolSequence=-1,parityData=-1;try{var currentCharacterSetECI=null,fc1InEffect=!1,mode=void 0;do{if(4>bits.available())mode=Mode_1.default.TERMINATOR;else{var modeBits=bits.readBits(4);mode=Mode_1.default.forBits(modeBits)}switch(mode){case Mode_1.default.TERMINATOR:break;case Mode_1.default.FNC1_FIRST_POSITION:case Mode_1.default.FNC1_SECOND_POSITION:fc1InEffect=!0;break;case Mode_1.default.STRUCTURED_APPEND:if(16>bits.available())throw new FormatException_1.default;
symbolSequence=bits.readBits(8);parityData=bits.readBits(8);break;case Mode_1.default.ECI:var value=DecodedBitStreamParser.parseECIValue(bits);currentCharacterSetECI=CharacterSetECI_1.default.getCharacterSetECIByValue(value);if(null===currentCharacterSetECI)throw new FormatException_1.default;break;case Mode_1.default.HANZI:var subset=bits.readBits(4),countHanzi=bits.readBits(mode.getCharacterCountBits(version));subset===DecodedBitStreamParser.GB2312_SUBSET&&DecodedBitStreamParser.decodeHanziSegment(bits,
result,countHanzi);break;default:var count=bits.readBits(mode.getCharacterCountBits(version));switch(mode){case Mode_1.default.NUMERIC:DecodedBitStreamParser.decodeNumericSegment(bits,result,count);break;case Mode_1.default.ALPHANUMERIC:DecodedBitStreamParser.decodeAlphanumericSegment(bits,result,count,fc1InEffect);break;case Mode_1.default.BYTE:DecodedBitStreamParser.decodeByteSegment(bits,result,count,currentCharacterSetECI,byteSegments,hints);break;case Mode_1.default.KANJI:DecodedBitStreamParser.decodeKanjiSegment(bits,
result,count);break;default:throw new FormatException_1.default;}}}while(mode!==Mode_1.default.TERMINATOR)}catch(iae){throw new FormatException_1.default;}return new DecoderResult_1.default(bytes,result.toString(),0===byteSegments.length?null:byteSegments,null===ecLevel?null:ecLevel.toString(),symbolSequence,parityData)};DecodedBitStreamParser.decodeHanziSegment=function(bits,result,count){if(13*count>bits.available())throw new FormatException_1.default;for(var buffer=new Uint8Array(2*count),offset=
0;0<count;){var twoBytes=bits.readBits(13);twoBytes=twoBytes/96<<8&4294967295|twoBytes%96;twoBytes=959>twoBytes?twoBytes+41377:twoBytes+42657;buffer[offset]=twoBytes>>8&255;buffer[offset+1]=twoBytes&255;offset+=2;count--}try{result.append(StringEncoding_1.default.decode(buffer,StringUtils_1.default.GB2312))}catch(ignored){throw new FormatException_1.default(ignored);}};DecodedBitStreamParser.decodeKanjiSegment=function(bits,result,count){if(13*count>bits.available())throw new FormatException_1.default;
for(var buffer=new Uint8Array(2*count),offset=0;0<count;){var twoBytes=bits.readBits(13);twoBytes=twoBytes/192<<8&4294967295|twoBytes%192;twoBytes=7936>twoBytes?twoBytes+33088:twoBytes+49472;buffer[offset]=twoBytes>>8;buffer[offset+1]=twoBytes;offset+=2;count--}try{result.append(StringEncoding_1.default.decode(buffer,StringUtils_1.default.SHIFT_JIS))}catch(ignored){throw new FormatException_1.default(ignored);}};DecodedBitStreamParser.decodeByteSegment=function(bits,result,count,currentCharacterSetECI,
byteSegments,hints){if(8*count>bits.available())throw new FormatException_1.default;for(var readBytes=new Uint8Array(count),i=0;i<count;i++)readBytes[i]=bits.readBits(8);bits=null===currentCharacterSetECI?StringUtils_1.default.guessEncoding(readBytes,hints):currentCharacterSetECI.getName();try{result.append(StringEncoding_1.default.decode(readBytes,bits))}catch(ignored){throw new FormatException_1.default(ignored);}byteSegments.push(readBytes)};DecodedBitStreamParser.toAlphaNumericChar=function(value){if(value>=
DecodedBitStreamParser.ALPHANUMERIC_CHARS.length)throw new FormatException_1.default;return DecodedBitStreamParser.ALPHANUMERIC_CHARS[value]};DecodedBitStreamParser.decodeAlphanumericSegment=function(bits,result,count,fc1InEffect){for(var start=result.length();1<count;){if(11>bits.available())throw new FormatException_1.default;var nextTwoCharsBits=bits.readBits(11);result.append(DecodedBitStreamParser.toAlphaNumericChar(Math.floor(nextTwoCharsBits/45)));result.append(DecodedBitStreamParser.toAlphaNumericChar(nextTwoCharsBits%
45));count-=2}if(1===count){if(6>bits.available())throw new FormatException_1.default;result.append(DecodedBitStreamParser.toAlphaNumericChar(bits.readBits(6)))}if(fc1InEffect)for(bits=start;bits<result.length();bits++)"%"===result.charAt(bits)&&(bits<result.length()-1&&"%"===result.charAt(bits+1)?result.deleteCharAt(bits+1):result.setCharAt(bits,String.fromCharCode(29)))};DecodedBitStreamParser.decodeNumericSegment=function(bits,result,count){for(;3<=count;){if(10>bits.available())throw new FormatException_1.default;
var threeDigitsBits=bits.readBits(10);if(1E3<=threeDigitsBits)throw new FormatException_1.default;result.append(DecodedBitStreamParser.toAlphaNumericChar(Math.floor(threeDigitsBits/100)));result.append(DecodedBitStreamParser.toAlphaNumericChar(Math.floor(threeDigitsBits/10)%10));result.append(DecodedBitStreamParser.toAlphaNumericChar(threeDigitsBits%10));count-=3}if(2===count){if(7>bits.available())throw new FormatException_1.default;bits=bits.readBits(7);if(100<=bits)throw new FormatException_1.default;
result.append(DecodedBitStreamParser.toAlphaNumericChar(Math.floor(bits/10)));result.append(DecodedBitStreamParser.toAlphaNumericChar(bits%10))}else if(1===count){if(4>bits.available())throw new FormatException_1.default;bits=bits.readBits(4);if(10<=bits)throw new FormatException_1.default;result.append(DecodedBitStreamParser.toAlphaNumericChar(bits))}};DecodedBitStreamParser.parseECIValue=function(bits){var firstByte=bits.readBits(8);if(0===(firstByte&128))return firstByte&127;if(128===(firstByte&
192))return bits=bits.readBits(8),(firstByte&63)<<8&4294967295|bits;if(192===(firstByte&224))return bits=bits.readBits(16),(firstByte&31)<<16&4294967295|bits;throw new FormatException_1.default;};DecodedBitStreamParser.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";DecodedBitStreamParser.GB2312_SUBSET=1;return DecodedBitStreamParser}();exports.default=global}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$qrcode$decoder$DecodedBitStreamParser.js.map
