shadow$provide.module$node_modules$$zxing$library$cjs$core$aztec$encoder$State=function(global,require,module,exports){var __values=this&&this.__values||function(o){var s="function"===typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"===typeof o.length)return{next:function(){o&&i>=o.length&&(o=void 0);return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.");};Object.defineProperty(exports,"__esModule",{value:!0});
var BitArray_1=require("module$node_modules$$zxing$library$cjs$core$common$BitArray"),TokenHelpers=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$TokenHelpers"),C=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$EncoderConstants"),LatchTable=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$LatchTable"),ShiftTable=require("module$node_modules$$zxing$library$cjs$core$aztec$encoder$ShiftTable"),StringUtils_1=require("module$node_modules$$zxing$library$cjs$core$common$StringUtils");
global=function(){function State(token,mode,binaryBytes,bitCount){this.token=token;this.mode=mode;this.binaryShiftByteCount=binaryBytes;this.bitCount=bitCount}State.prototype.getMode=function(){return this.mode};State.prototype.getToken=function(){return this.token};State.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount};State.prototype.getBitCount=function(){return this.bitCount};State.prototype.latchAndAppend=function(mode,value){var bitCount=this.bitCount,token=this.token;
if(mode!==this.mode){var latch=LatchTable.LATCH_TABLE[this.mode][mode];token=TokenHelpers.add(token,latch&65535,latch>>16);bitCount+=latch>>16}latch=mode===C.MODE_DIGIT?4:5;token=TokenHelpers.add(token,value,latch);return new State(token,mode,0,bitCount+latch)};State.prototype.shiftAndAppend=function(mode,value){var token=this.token,thisModeBitCount=this.mode===C.MODE_DIGIT?4:5;token=TokenHelpers.add(token,ShiftTable.SHIFT_TABLE[this.mode][mode],thisModeBitCount);token=TokenHelpers.add(token,value,
5);return new State(token,this.mode,0,this.bitCount+thisModeBitCount+5)};State.prototype.addBinaryShiftChar=function(index){var token=this.token,mode=this.mode,bitCount=this.bitCount;if(this.mode===C.MODE_PUNCT||this.mode===C.MODE_DIGIT)mode=LatchTable.LATCH_TABLE[mode][C.MODE_UPPER],token=TokenHelpers.add(token,mode&65535,mode>>16),bitCount+=mode>>16,mode=C.MODE_UPPER;token=new State(token,mode,this.binaryShiftByteCount+1,bitCount+(0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:
62===this.binaryShiftByteCount?9:8));2078===token.binaryShiftByteCount&&(token=token.endBinaryShift(index+1));return token};State.prototype.endBinaryShift=function(index){if(0===this.binaryShiftByteCount)return this;var token=this.token;token=TokenHelpers.addBinaryShift(token,index-this.binaryShiftByteCount,this.binaryShiftByteCount);return new State(token,this.mode,0,this.bitCount)};State.prototype.isBetterThanOrEqualTo=function(other){var newModeBitCount=this.bitCount+(LatchTable.LATCH_TABLE[this.mode][other.mode]>>
16);this.binaryShiftByteCount<other.binaryShiftByteCount?newModeBitCount+=State.calculateBinaryShiftCost(other)-State.calculateBinaryShiftCost(this):this.binaryShiftByteCount>other.binaryShiftByteCount&&0<other.binaryShiftByteCount&&(newModeBitCount+=10);return newModeBitCount<=other.bitCount};State.prototype.toBitArray=function(text){for(var e_1,_a,symbols=[],token=this.endBinaryShift(text.length).token;null!==token;token=token.getPrevious())symbols.unshift(token);token=new BitArray_1.default;try{for(var symbols_1=
__values(symbols),symbols_1_1=symbols_1.next();!symbols_1_1.done;symbols_1_1=symbols_1.next())symbols_1_1.value.appendTo(token,text)}catch(e_1_1){e_1={error:e_1_1}}finally{try{symbols_1_1&&!symbols_1_1.done&&(_a=symbols_1.return)&&_a.call(symbols_1)}finally{if(e_1)throw e_1.error;}}return token};State.prototype.toString=function(){return StringUtils_1.default.format("%s bits\x3d%d bytes\x3d%d",C.MODE_NAMES[this.mode],this.bitCount,this.binaryShiftByteCount)};State.calculateBinaryShiftCost=function(state){return 62<
state.binaryShiftByteCount?21:31<state.binaryShiftByteCount?20:0<state.binaryShiftByteCount?10:0};State.INITIAL_STATE=new State(C.EMPTY_TOKEN,C.MODE_UPPER,0,0);return State}();exports.default=global}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$aztec$encoder$State.js.map
