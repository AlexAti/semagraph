shadow$provide.module$node_modules$$zxing$library$cjs$core$qrcode$detector$AlignmentPatternFinder=function(global,require,module,exports){var __values=this&&this.__values||function(o){var s="function"===typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"===typeof o.length)return{next:function(){o&&i>=o.length&&(o=void 0);return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.");};Object.defineProperty(exports,
"__esModule",{value:!0});var AlignmentPattern_1=require("module$node_modules$$zxing$library$cjs$core$qrcode$detector$AlignmentPattern"),NotFoundException_1=require("module$node_modules$$zxing$library$cjs$core$NotFoundException");global=function(){function AlignmentPatternFinder(image,startX,startY,width,height,moduleSize,resultPointCallback){this.image=image;this.startX=startX;this.startY=startY;this.width=width;this.height=height;this.moduleSize=moduleSize;this.resultPointCallback=resultPointCallback;
this.possibleCenters=[];this.crossCheckStateCount=new Int32Array(3)}AlignmentPatternFinder.prototype.find=function(){for(var startX=this.startX,height=this.height,maxJ=startX+this.width,middleI=this.startY+height/2,stateCount=new Int32Array(3),image=this.image,iGen=0;iGen<height;iGen++){var i=middleI+(0===(iGen&1)?Math.floor((iGen+1)/2):-Math.floor((iGen+1)/2));stateCount[0]=0;stateCount[1]=0;stateCount[2]=0;for(var j=startX;j<maxJ&&!image.get(j,i);)j++;for(var currentState=0;j<maxJ;){if(image.get(j,
i))if(1===currentState)stateCount[1]++;else if(2===currentState){if(this.foundPatternCross(stateCount)&&(currentState=this.handlePossibleCenter(stateCount,i,j),null!==currentState))return currentState;stateCount[0]=stateCount[2];stateCount[1]=1;stateCount[2]=0;currentState=1}else stateCount[++currentState]++;else 1===currentState&&currentState++,stateCount[currentState]++;j++}if(this.foundPatternCross(stateCount)&&(currentState=this.handlePossibleCenter(stateCount,i,maxJ),null!==currentState))return currentState}if(0!==
this.possibleCenters.length)return this.possibleCenters[0];throw new NotFoundException_1.default;};AlignmentPatternFinder.centerFromEnd=function(stateCount,end){return end-stateCount[2]-stateCount[1]/2};AlignmentPatternFinder.prototype.foundPatternCross=function(stateCount){for(var moduleSize=this.moduleSize,maxVariance=moduleSize/2,i=0;3>i;i++)if(Math.abs(moduleSize-stateCount[i])>=maxVariance)return!1;return!0};AlignmentPatternFinder.prototype.crossCheckVertical=function(startI,centerJ,maxCount,
originalStateCountTotal){var image=this.image,maxI=image.getHeight(),stateCount=this.crossCheckStateCount;stateCount[0]=0;stateCount[1]=0;stateCount[2]=0;for(var i=startI;0<=i&&image.get(centerJ,i)&&stateCount[1]<=maxCount;)stateCount[1]++,i--;if(0>i||stateCount[1]>maxCount)return NaN;for(;0<=i&&!image.get(centerJ,i)&&stateCount[0]<=maxCount;)stateCount[0]++,i--;if(stateCount[0]>maxCount)return NaN;for(i=startI+1;i<maxI&&image.get(centerJ,i)&&stateCount[1]<=maxCount;)stateCount[1]++,i++;if(i===maxI||
stateCount[1]>maxCount)return NaN;for(;i<maxI&&!image.get(centerJ,i)&&stateCount[2]<=maxCount;)stateCount[2]++,i++;return stateCount[2]>maxCount||5*Math.abs(stateCount[0]+stateCount[1]+stateCount[2]-originalStateCountTotal)>=2*originalStateCountTotal?NaN:this.foundPatternCross(stateCount)?AlignmentPatternFinder.centerFromEnd(stateCount,i):NaN};AlignmentPatternFinder.prototype.handlePossibleCenter=function(stateCount,i,j){var _a,stateCountTotal=stateCount[0]+stateCount[1]+stateCount[2];j=AlignmentPatternFinder.centerFromEnd(stateCount,
j);i=this.crossCheckVertical(i,j,2*stateCount[1],stateCountTotal);if(!isNaN(i)){stateCount=(stateCount[0]+stateCount[1]+stateCount[2])/3;try{for(var _b=__values(this.possibleCenters),_c=_b.next();!_c.done;_c=_b.next()){var center=_c.value;if(center.aboutEquals(stateCount,i,j))return center.combineEstimate(i,j,stateCount)}}catch(e_1_1){var e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error;}}e_1=new AlignmentPattern_1.default(j,i,stateCount);this.possibleCenters.push(e_1);
null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(e_1)}return null};return AlignmentPatternFinder}();exports.default=global}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$qrcode$detector$AlignmentPatternFinder.js.map
