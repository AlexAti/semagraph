shadow$provide.module$node_modules$$zxing$library$cjs$core$pdf417$decoder$DecodedBitStreamParser=function(global,require,module,exports){function getBigIntConstructor(){if("undefined"!==typeof window)return window.BigInt||null;if("undefined"!==typeof global)return global.BigInt||null;if("undefined"!==typeof self)return self.BigInt||null;throw Error("Can't search globals for BigInt!");}function createBigInt(num){"undefined"===typeof BigInteger&&(BigInteger=getBigIntConstructor());if(null===BigInteger)throw Error("BigInt is not supported!");
return BigInteger(num)}function getEXP900(){var EXP900=[];EXP900[0]=createBigInt(1);var nineHundred=createBigInt(900);EXP900[1]=nineHundred;for(var i=2;16>i;i++)EXP900[i]=EXP900[i-1]*nineHundred;return EXP900}Object.defineProperty(exports,"__esModule",{value:!0});var FormatException_1=require("module$node_modules$$zxing$library$cjs$core$FormatException"),CharacterSetECI_1=require("module$node_modules$$zxing$library$cjs$core$common$CharacterSetECI"),DecoderResult_1=require("module$node_modules$$zxing$library$cjs$core$common$DecoderResult"),
PDF417ResultMetadata_1=require("module$node_modules$$zxing$library$cjs$core$pdf417$PDF417ResultMetadata"),Arrays_1=require("module$node_modules$$zxing$library$cjs$core$util$Arrays"),StringBuilder_1=require("module$node_modules$$zxing$library$cjs$core$util$StringBuilder"),Integer_1=require("module$node_modules$$zxing$library$cjs$core$util$Integer"),Long_1=require("module$node_modules$$zxing$library$cjs$core$util$Long"),ByteArrayOutputStream_1=require("module$node_modules$$zxing$library$cjs$core$util$ByteArrayOutputStream"),
StringEncoding_1=require("module$node_modules$$zxing$library$cjs$core$util$StringEncoding"),Mode$jscomp$0;(function(Mode){Mode[Mode.ALPHA=0]="ALPHA";Mode[Mode.LOWER=1]="LOWER";Mode[Mode.MIXED=2]="MIXED";Mode[Mode.PUNCT=3]="PUNCT";Mode[Mode.ALPHA_SHIFT=4]="ALPHA_SHIFT";Mode[Mode.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Mode$jscomp$0||(Mode$jscomp$0={}));var BigInteger;require=function(){function DecodedBitStreamParser(){}DecodedBitStreamParser.decode=function(codewords,ecLevel){var result=new StringBuilder_1.default(""),
encoding=CharacterSetECI_1.default.ISO8859_1;result.enableDecoding(encoding);for(var codeIndex=1,code=codewords[codeIndex++],resultMetadata=new PDF417ResultMetadata_1.default;codeIndex<codewords[0];){switch(code){case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:codeIndex=DecodedBitStreamParser.textCompaction(codewords,codeIndex,result);break;case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6:codeIndex=DecodedBitStreamParser.byteCompaction(code,
codewords,encoding,codeIndex,result);break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(codewords[codeIndex++]);break;case DecodedBitStreamParser.NUMERIC_COMPACTION_MODE_LATCH:codeIndex=DecodedBitStreamParser.numericCompaction(codewords,codeIndex,result);break;case DecodedBitStreamParser.ECI_CHARSET:CharacterSetECI_1.default.getCharacterSetECIByValue(codewords[codeIndex++]);break;case DecodedBitStreamParser.ECI_GENERAL_PURPOSE:codeIndex+=2;break;case DecodedBitStreamParser.ECI_USER_DEFINED:codeIndex++;
break;case DecodedBitStreamParser.BEGIN_MACRO_PDF417_CONTROL_BLOCK:codeIndex=DecodedBitStreamParser.decodeMacroBlock(codewords,codeIndex,resultMetadata);break;case DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser.MACRO_PDF417_TERMINATOR:throw new FormatException_1.default;default:codeIndex--,codeIndex=DecodedBitStreamParser.textCompaction(codewords,codeIndex,result)}if(codeIndex<codewords.length)code=codewords[codeIndex++];else throw FormatException_1.default.getFormatInstance();
}if(0===result.length())throw FormatException_1.default.getFormatInstance();codewords=new DecoderResult_1.default(null,result.toString(),null,ecLevel);codewords.setOther(resultMetadata);return codewords};DecodedBitStreamParser.decodeMacroBlock=function(codewords,codeIndex,resultMetadata){if(codeIndex+DecodedBitStreamParser.NUMBER_OF_SEQUENCE_CODEWORDS>codewords[0])throw FormatException_1.default.getFormatInstance();for(var segmentIndexArray=new Int32Array(DecodedBitStreamParser.NUMBER_OF_SEQUENCE_CODEWORDS),
i=0;i<DecodedBitStreamParser.NUMBER_OF_SEQUENCE_CODEWORDS;i++,codeIndex++)segmentIndexArray[i]=codewords[codeIndex];resultMetadata.setSegmentIndex(Integer_1.default.parseInt(DecodedBitStreamParser.decodeBase900toBase10(segmentIndexArray,DecodedBitStreamParser.NUMBER_OF_SEQUENCE_CODEWORDS)));segmentIndexArray=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.textCompaction(codewords,codeIndex,segmentIndexArray);resultMetadata.setFileId(segmentIndexArray.toString());segmentIndexArray=-1;
for(codewords[codeIndex]===DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(segmentIndexArray=codeIndex+1);codeIndex<codewords[0];)switch(codewords[codeIndex]){case DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:codeIndex++;switch(codewords[codeIndex]){case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:i=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.textCompaction(codewords,codeIndex+1,i);resultMetadata.setFileName(i.toString());break;case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_SENDER:i=
new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.textCompaction(codewords,codeIndex+1,i);resultMetadata.setSender(i.toString());break;case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:i=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.textCompaction(codewords,codeIndex+1,i);resultMetadata.setAddressee(i.toString());break;case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:i=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.numericCompaction(codewords,
codeIndex+1,i);resultMetadata.setSegmentCount(Integer_1.default.parseInt(i.toString()));break;case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:i=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.numericCompaction(codewords,codeIndex+1,i);resultMetadata.setTimestamp(Long_1.default.parseLong(i.toString()));break;case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:i=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.numericCompaction(codewords,codeIndex+
1,i);resultMetadata.setChecksum(Integer_1.default.parseInt(i.toString()));break;case DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:i=new StringBuilder_1.default;codeIndex=DecodedBitStreamParser.numericCompaction(codewords,codeIndex+1,i);resultMetadata.setFileSize(Long_1.default.parseLong(i.toString()));break;default:throw FormatException_1.default.getFormatInstance();}break;case DecodedBitStreamParser.MACRO_PDF417_TERMINATOR:codeIndex++;resultMetadata.setLastSegment(!0);break;default:throw FormatException_1.default.getFormatInstance();
}-1!==segmentIndexArray&&(i=codeIndex-segmentIndexArray,resultMetadata.isLastSegment()&&i--,resultMetadata.setOptionalData(Arrays_1.default.copyOfRange(codewords,segmentIndexArray,segmentIndexArray+i)));return codeIndex};DecodedBitStreamParser.textCompaction=function(codewords,codeIndex,result){for(var textCompactionData=new Int32Array(2*(codewords[0]-codeIndex)),byteCompactionData=new Int32Array(2*(codewords[0]-codeIndex)),index=0,end=!1;codeIndex<codewords[0]&&!end;){var code=codewords[codeIndex++];
if(code<DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH)textCompactionData[index]=code/30,textCompactionData[index+1]=code%30,index+=2;else switch(code){case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:textCompactionData[index++]=DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH;break;case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser.MACRO_PDF417_TERMINATOR:codeIndex--;
end=!0;break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:textCompactionData[index]=DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,code=codewords[codeIndex++],byteCompactionData[index]=code,index++}}DecodedBitStreamParser.decodeTextCompaction(textCompactionData,byteCompactionData,index,result);return codeIndex};DecodedBitStreamParser.decodeTextCompaction=function(textCompactionData,byteCompactionData,length,result){for(var subMode=Mode$jscomp$0.ALPHA,priorToShiftMode=
Mode$jscomp$0.ALPHA,i=0;i<length;){var subModeCh=textCompactionData[i],ch="";switch(subMode){case Mode$jscomp$0.ALPHA:if(26>subModeCh)ch=String.fromCharCode(65+subModeCh);else switch(subModeCh){case 26:ch=" ";break;case DecodedBitStreamParser.LL:subMode=Mode$jscomp$0.LOWER;break;case DecodedBitStreamParser.ML:subMode=Mode$jscomp$0.MIXED;break;case DecodedBitStreamParser.PS:priorToShiftMode=subMode;subMode=Mode$jscomp$0.PUNCT_SHIFT;break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);
break;case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$jscomp$0.ALPHA}break;case Mode$jscomp$0.LOWER:if(26>subModeCh)ch=String.fromCharCode(97+subModeCh);else switch(subModeCh){case 26:ch=" ";break;case DecodedBitStreamParser.AS:priorToShiftMode=subMode;subMode=Mode$jscomp$0.ALPHA_SHIFT;break;case DecodedBitStreamParser.ML:subMode=Mode$jscomp$0.MIXED;break;case DecodedBitStreamParser.PS:priorToShiftMode=subMode;subMode=Mode$jscomp$0.PUNCT_SHIFT;break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);
break;case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$jscomp$0.ALPHA}break;case Mode$jscomp$0.MIXED:if(subModeCh<DecodedBitStreamParser.PL)ch=DecodedBitStreamParser.MIXED_CHARS[subModeCh];else switch(subModeCh){case DecodedBitStreamParser.PL:subMode=Mode$jscomp$0.PUNCT;break;case 26:ch=" ";break;case DecodedBitStreamParser.LL:subMode=Mode$jscomp$0.LOWER;break;case DecodedBitStreamParser.AL:subMode=Mode$jscomp$0.ALPHA;break;case DecodedBitStreamParser.PS:priorToShiftMode=subMode;
subMode=Mode$jscomp$0.PUNCT_SHIFT;break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$jscomp$0.ALPHA}break;case Mode$jscomp$0.PUNCT:if(subModeCh<DecodedBitStreamParser.PAL)ch=DecodedBitStreamParser.PUNCT_CHARS[subModeCh];else switch(subModeCh){case DecodedBitStreamParser.PAL:subMode=Mode$jscomp$0.ALPHA;break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);
break;case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$jscomp$0.ALPHA}break;case Mode$jscomp$0.ALPHA_SHIFT:subMode=priorToShiftMode;if(26>subModeCh)ch=String.fromCharCode(65+subModeCh);else switch(subModeCh){case 26:ch=" ";break;case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$jscomp$0.ALPHA}break;case Mode$jscomp$0.PUNCT_SHIFT:if(subMode=priorToShiftMode,subModeCh<DecodedBitStreamParser.PAL)ch=DecodedBitStreamParser.PUNCT_CHARS[subModeCh];else switch(subModeCh){case DecodedBitStreamParser.PAL:subMode=
Mode$jscomp$0.ALPHA;break;case DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:result.append(byteCompactionData[i]);break;case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:subMode=Mode$jscomp$0.ALPHA}}""!==ch&&result.append(ch);i++}};DecodedBitStreamParser.byteCompaction=function(mode,codewords,encoding,codeIndex,result){var decodedBytes=new ByteArrayOutputStream_1.default,count=0,value=0,end=!1;switch(mode){case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH:mode=new Int32Array(6);
for(var nextCode=codewords[codeIndex++];codeIndex<codewords[0]&&!end;)switch(mode[count++]=nextCode,value=900*value+nextCode,nextCode=codewords[codeIndex++],nextCode){case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser.MACRO_PDF417_TERMINATOR:codeIndex--;
end=!0;break;default:if(0===count%5&&0<count){for(count=0;6>count;++count)decodedBytes.write(Number(createBigInt(value)>>createBigInt(8*(5-count))));count=value=0}}codeIndex===codewords[0]&&nextCode<DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH&&(mode[count++]=nextCode);for(codewords=0;codewords<count;codewords++)decodedBytes.write(mode[codewords]);break;case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6:for(;codeIndex<codewords[0]&&!end;){mode=codewords[codeIndex++];if(mode<DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH)count++,
value=900*value+mode;else switch(mode){case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.NUMERIC_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser.MACRO_PDF417_TERMINATOR:codeIndex--,end=!0}if(0===count%5&&0<count){for(count=0;6>count;++count)decodedBytes.write(Number(createBigInt(value)>>
createBigInt(8*(5-count))));count=value=0}}}result.append(StringEncoding_1.default.decode(decodedBytes.toByteArray(),encoding));return codeIndex};DecodedBitStreamParser.numericCompaction=function(codewords,codeIndex,result){for(var count=0,end=!1,numericCodewords=new Int32Array(DecodedBitStreamParser.MAX_NUMERIC_CODEWORDS);codeIndex<codewords[0]&&!end;){var code=codewords[codeIndex++];codeIndex===codewords[0]&&(end=!0);if(code<DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH)numericCodewords[count]=
code,count++;else switch(code){case DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH:case DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case DecodedBitStreamParser.MACRO_PDF417_TERMINATOR:codeIndex--,end=!0}(0===count%DecodedBitStreamParser.MAX_NUMERIC_CODEWORDS||code===DecodedBitStreamParser.NUMERIC_COMPACTION_MODE_LATCH||
end)&&0<count&&(result.append(DecodedBitStreamParser.decodeBase900toBase10(numericCodewords,count)),count=0)}return codeIndex};DecodedBitStreamParser.decodeBase900toBase10=function(codewords,count){for(var result=createBigInt(0),i=0;i<count;i++)result+=DecodedBitStreamParser.EXP900[count-i-1]*createBigInt(codewords[i]);codewords=result.toString();if("1"!==codewords.charAt(0))throw new FormatException_1.default;return codewords.substring(1)};DecodedBitStreamParser.TEXT_COMPACTION_MODE_LATCH=900;DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH=
901;DecodedBitStreamParser.NUMERIC_COMPACTION_MODE_LATCH=902;DecodedBitStreamParser.BYTE_COMPACTION_MODE_LATCH_6=924;DecodedBitStreamParser.ECI_USER_DEFINED=925;DecodedBitStreamParser.ECI_GENERAL_PURPOSE=926;DecodedBitStreamParser.ECI_CHARSET=927;DecodedBitStreamParser.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928;DecodedBitStreamParser.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923;DecodedBitStreamParser.MACRO_PDF417_TERMINATOR=922;DecodedBitStreamParser.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913;DecodedBitStreamParser.MAX_NUMERIC_CODEWORDS=
15;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5;DecodedBitStreamParser.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6;DecodedBitStreamParser.PL=25;DecodedBitStreamParser.LL=27;
DecodedBitStreamParser.AS=27;DecodedBitStreamParser.ML=28;DecodedBitStreamParser.AL=28;DecodedBitStreamParser.PS=29;DecodedBitStreamParser.PAL=29;DecodedBitStreamParser.PUNCT_CHARS=";\x3c\x3e@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'";DecodedBitStreamParser.MIXED_CHARS="0123456789\x26\r\t,:#-.$/+%*\x3d^";DecodedBitStreamParser.EXP900=getBigIntConstructor()?getEXP900():[];DecodedBitStreamParser.NUMBER_OF_SEQUENCE_CODEWORDS=2;return DecodedBitStreamParser}();exports.default=require}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$pdf417$decoder$DecodedBitStreamParser.js.map
