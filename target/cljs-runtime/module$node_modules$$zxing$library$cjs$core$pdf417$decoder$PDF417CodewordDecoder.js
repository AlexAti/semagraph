shadow$provide.module$node_modules$$zxing$library$cjs$core$pdf417$decoder$PDF417CodewordDecoder=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var MathUtils_1=require("module$node_modules$$zxing$library$cjs$core$common$detector$MathUtils"),PDF417Common_1=require("module$node_modules$$zxing$library$cjs$core$pdf417$PDF417Common"),Float_1=require("module$node_modules$$zxing$library$cjs$core$util$Float");global=function(){function PDF417CodewordDecoder(){}
PDF417CodewordDecoder.initialize=function(){for(var i=0;i<PDF417Common_1.default.SYMBOL_TABLE.length;i++)for(var currentSymbol=PDF417Common_1.default.SYMBOL_TABLE[i],currentBit=currentSymbol&1,j=0;j<PDF417Common_1.default.BARS_IN_MODULE;j++){for(var size=0;(currentSymbol&1)===currentBit;)size+=1,currentSymbol>>=1;currentBit=currentSymbol&1;PDF417CodewordDecoder.RATIOS_TABLE[i]||(PDF417CodewordDecoder.RATIOS_TABLE[i]=Array(PDF417Common_1.default.BARS_IN_MODULE));PDF417CodewordDecoder.RATIOS_TABLE[i][PDF417Common_1.default.BARS_IN_MODULE-
j-1]=Math.fround(size/PDF417Common_1.default.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0};PDF417CodewordDecoder.getDecodedValue=function(moduleBitCount){var decodedValue=PDF417CodewordDecoder.getDecodedCodewordValue(PDF417CodewordDecoder.sampleBitCounts(moduleBitCount));return-1!==decodedValue?decodedValue:PDF417CodewordDecoder.getClosestDecodedValue(moduleBitCount)};PDF417CodewordDecoder.sampleBitCounts=function(moduleBitCount){for(var bitCountSum=MathUtils_1.default.sum(moduleBitCount),result=
new Int32Array(PDF417Common_1.default.BARS_IN_MODULE),bitCountIndex=0,sumPreviousBits=0,i=0;i<PDF417Common_1.default.MODULES_IN_CODEWORD;i++)sumPreviousBits+moduleBitCount[bitCountIndex]<=bitCountSum/(2*PDF417Common_1.default.MODULES_IN_CODEWORD)+i*bitCountSum/PDF417Common_1.default.MODULES_IN_CODEWORD&&(sumPreviousBits+=moduleBitCount[bitCountIndex],bitCountIndex++),result[bitCountIndex]++;return result};PDF417CodewordDecoder.getDecodedCodewordValue=function(moduleBitCount){moduleBitCount=PDF417CodewordDecoder.getBitValue(moduleBitCount);
return-1===PDF417Common_1.default.getCodeword(moduleBitCount)?-1:moduleBitCount};PDF417CodewordDecoder.getBitValue=function(moduleBitCount){for(var result=0,i=0;i<moduleBitCount.length;i++)for(var bit=0;bit<moduleBitCount[i];bit++)result=result<<1|(0===i%2?1:0);return Math.trunc(result)};PDF417CodewordDecoder.getClosestDecodedValue=function(moduleBitCount){var bitCountSum=MathUtils_1.default.sum(moduleBitCount),bitCountRatios=Array(PDF417Common_1.default.BARS_IN_MODULE);if(1<bitCountSum)for(var i=
0;i<bitCountRatios.length;i++)bitCountRatios[i]=Math.fround(moduleBitCount[i]/bitCountSum);moduleBitCount=Float_1.default.MAX_VALUE;bitCountSum=-1;this.bSymbolTableReady||PDF417CodewordDecoder.initialize();for(i=0;i<PDF417CodewordDecoder.RATIOS_TABLE.length;i++){for(var error=0,ratioTableRow=PDF417CodewordDecoder.RATIOS_TABLE[i],k=0;k<PDF417Common_1.default.BARS_IN_MODULE;k++){var diff=Math.fround(ratioTableRow[k]-bitCountRatios[k]);error+=Math.fround(diff*diff);if(error>=moduleBitCount)break}error<
moduleBitCount&&(moduleBitCount=error,bitCountSum=PDF417Common_1.default.SYMBOL_TABLE[i])}return bitCountSum};PDF417CodewordDecoder.bSymbolTableReady=!1;PDF417CodewordDecoder.RATIOS_TABLE=Array(PDF417Common_1.default.SYMBOL_TABLE.length).map(function(x){return Array(PDF417Common_1.default.BARS_IN_MODULE)});return PDF417CodewordDecoder}();exports.default=global}
//# sourceMappingURL=module$node_modules$$zxing$library$cjs$core$pdf417$decoder$PDF417CodewordDecoder.js.map
